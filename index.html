<button id="restrictedButton" disabled>Click Me</button>
<p id="status">Checking location...</p>

<script>
const roomPolygon = [
  [6.244521, 6.208141],
  [6.244476, 6.208149],
  [6.244477, 6.208152],
  [6.244473, 6.208153],
  [6.244457, 6.208160],
  [6.244456, 6.208156],
];

function isPointInPolygon(point, polygon) {
  const [x, y] = point;
  let inside = false;

  for (let i = 0, j = polygon.length - 1; i < polygon.length; j = i++) {
    const xi = polygon[i][0], yi = polygon[i][1];
    const xj = polygon[j][0], yj = polygon[j][1];

    const intersect = ((yi > y) !== (yj > y)) &&
      (x < (xj - xi) * (y - yi) / (yj - yi) + xi);
    if (intersect) inside = !inside;
  }

  return inside;
}

const button = document.getElementById('restrictedButton');
const statusEl = document.getElementById('status');

if (navigator.geolocation) {
  navigator.geolocation.watchPosition(
    position => {
      const lat = position.coords.latitude;
      const lon = position.coords.longitude;

      const inside = isPointInPolygon([lat, lon], roomPolygon);

      if (inside) {
        button.disabled = false;
        statusEl.textContent = "✅ You are inside the room.";
      } else {
        button.disabled = true;
        statusEl.textContent = "❌ You are outside the room.";
      }
    },
    error => {
      statusEl.textContent = "Error: " + error.message;
    },
    { enableHighAccuracy: true, maximumAge: 0, timeout: 5000 }
  );
} else {
  statusEl.textContent = "Geolocation not supported by this browser.";
}

button.addEventListener('click', () => {
  alert('You clicked inside the room!');
});
</script>
